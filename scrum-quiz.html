<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Interactif Scrum - Avec Professeur 2D</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .professor-container {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
            gap: 20px;
        }

        .professor {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 60px;
            position: relative;
            animation: float 3s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .professor-face {
            font-size: 50px;
            margin-bottom: 10px;
        }

        .professor-glasses {
            font-size: 30px;
            position: absolute;
            top: 45px;
        }

        .speech-bubble {
            background: #f0f4ff;
            padding: 20px;
            border-radius: 15px;
            position: relative;
            flex: 1;
            border: 2px solid #667eea;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .speech-bubble:before {
            content: '';
            position: absolute;
            left: -15px;
            top: 30px;
            width: 0;
            height: 0;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
            border-right: 15px solid #667eea;
        }

        .speech-bubble:after {
            content: '';
            position: absolute;
            left: -11px;
            top: 32px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 12px solid #f0f4ff;
        }

        .question-container {
            margin: 30px 0;
        }

        .question {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-left: 5px solid #667eea;
            border-radius: 8px;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            padding: 18px 25px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1em;
        }

        .option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateX(5px);
        }

        .option.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }

        .option.incorrect {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .option.disabled {
            pointer-events: none;
            opacity: 0.6;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-help {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-help:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-help:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .progress-bar {
            background: #e0e0e0;
            height: 10px;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.5s ease;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.1em;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .welcome-screen, .results-screen {
            text-align: center;
            padding: 40px;
        }

        .welcome-screen h2 {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 20px;
        }

        .welcome-screen p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .results-screen h2 {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 20px;
        }

        .score-display {
            font-size: 4em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 30px 0;
        }

        .feedback-message {
            font-size: 1.3em;
            color: #555;
            margin: 20px 0;
        }

        .btn-download {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            margin-top: 20px;
        }

        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
        }

        .help-count {
            background: white;
            color: #f5576c;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .emoji {
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .professor-container {
                flex-direction: column;
                align-items: center;
            }

            .speech-bubble:before,
            .speech-bubble:after {
                display: none;
            }

            .content {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.5em;
            }
        }

        .loading {
            display: inline-block;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì Quiz Interactif Scrum</h1>
            <p>Testez vos connaissances avec l'aide de votre professeur virtuel !</p>
        </div>

        <div class="content" id="app">
            <!-- Le contenu sera g√©n√©r√© dynamiquement par JavaScript -->
        </div>
    </div>

    <script>
        // Base de donn√©es des questions
        const questionsData = [
            {
                question: "Qui est responsable de maximiser la valeur du produit dans Scrum ?",
                options: [
                    "Le Scrum Master",
                    "Le Product Owner",
                    "L'√©quipe de d√©veloppement",
                    "Le client"
                ],
                correct: 1,
                explanation: "Le Product Owner est le responsable unique de la gestion du Product Backlog et de maximiser la valeur du produit. Il d√©finit les priorit√©s, prend les d√©cisions sur ce qui doit √™tre d√©velopp√© et repr√©sente les parties prenantes aupr√®s de l'√©quipe."
            },
            {
                question: "Quelle est la dur√©e maximale recommand√©e pour un Sprint ?",
                options: [
                    "2 semaines",
                    "1 mois",
                    "3 mois",
                    "6 semaines"
                ],
                correct: 1,
                explanation: "Selon le Guide Scrum, un Sprint dure maximum 1 mois (4 semaines). En pratique, la plupart des √©quipes utilisent des Sprints de 2 semaines. Cette dur√©e permet d'avoir un cycle de feedback r√©gulier tout en ayant suffisamment de temps pour livrer de la valeur."
            },
            {
                question: "Quel est le r√¥le principal du Scrum Master ?",
                options: [
                    "Manager l'√©quipe de d√©veloppement",
                    "D√©cider des fonctionnalit√©s √† d√©velopper",
                    "Faciliter et √©liminer les obstacles",
                    "√âcrire le code"
                ],
                correct: 2,
                explanation: "Le Scrum Master est un servant-leader qui facilite le processus Scrum, √©limine les obstacles (impediments) qui bloquent l'√©quipe, et aide tout le monde √† comprendre et appliquer les valeurs et principes Scrum. Ce n'est PAS un chef de projet traditionnel."
            },
            {
                question: "Qu'est-ce que le Product Backlog ?",
                options: [
                    "La liste des bugs √† corriger",
                    "La liste ordonn√©e de tout ce qui pourrait √™tre n√©cessaire dans le produit",
                    "Le planning du prochain Sprint",
                    "Les t√¢ches termin√©es"
                ],
                correct: 1,
                explanation: "Le Product Backlog est une liste ordonn√©e et √©volutive de tout ce qui pourrait √™tre n√©cessaire dans le produit. Il contient des fonctionnalit√©s, des am√©liorations, des corrections de bugs, etc. Le Product Owner est responsable de son contenu, de sa disponibilit√© et de son ordre."
            },
            {
                question: "Combien de temps dure le Daily Scrum (r√©union quotidienne) ?",
                options: [
                    "15 minutes maximum",
                    "30 minutes maximum",
                    "1 heure maximum",
                    "Pas de limite de temps"
                ],
                correct: 0,
                explanation: "Le Daily Scrum est une r√©union quotidienne de 15 minutes maximum o√π l'√©quipe de d√©veloppement synchronise ses activit√©s et cr√©e un plan pour les prochaines 24 heures. C'est une r√©union debout (stand-up) pour garder l'√©nergie et la bri√®vet√©."
            },
            {
                question: "Que repr√©sente le Burndown Chart ?",
                options: [
                    "Le budget du projet",
                    "Le nombre de d√©veloppeurs",
                    "Le travail restant au fil du temps",
                    "La satisfaction du client"
                ],
                correct: 2,
                explanation: "Le Burndown Chart est un graphique qui montre le travail restant (en story points ou en heures) par rapport au temps restant dans le Sprint. Il permet de visualiser la progression et d'identifier rapidement si l'√©quipe est sur la bonne voie pour terminer le Sprint."
            },
            {
                question: "Quelle est une des valeurs fondamentales de Scrum ?",
                options: [
                    "Profit",
                    "Courage",
                    "Rapidit√©",
                    "Comp√©tition"
                ],
                correct: 1,
                explanation: "Les 5 valeurs de Scrum sont : Engagement, Focus, Ouverture, Respect et Courage. Le courage signifie avoir le courage de faire les bonnes choses et de travailler sur des probl√®mes difficiles, d'admettre ses erreurs et de demander de l'aide quand n√©cessaire."
            },
            {
                question: "Qui participe au Sprint Planning ?",
                options: [
                    "Seulement le Product Owner",
                    "Seulement l'√©quipe de d√©veloppement",
                    "Toute l'√©quipe Scrum (PO, SM, √âquipe Dev)",
                    "Seulement le Scrum Master"
                ],
                correct: 2,
                explanation: "Le Sprint Planning r√©unit toute l'√©quipe Scrum : le Product Owner pr√©sente les objectifs et les √©l√©ments du backlog, l'√©quipe de d√©veloppement estime et planifie le travail, et le Scrum Master facilite la r√©union. C'est un effort collaboratif."
            },
            {
                question: "Que se passe-t-il lors de la Sprint Review ?",
                options: [
                    "L'√©quipe planifie le prochain Sprint",
                    "L'√©quipe pr√©sente l'incr√©ment termin√© aux parties prenantes",
                    "L'√©quipe fait sa r√©trospective",
                    "Le Product Owner d√©finit les priorit√©s"
                ],
                correct: 1,
                explanation: "La Sprint Review est une r√©union informelle √† la fin du Sprint o√π l'√©quipe pr√©sente l'incr√©ment termin√© (produit fonctionnel) aux parties prenantes. On recueille les feedbacks qui peuvent influencer le Product Backlog et les prochains Sprints."
            },
            {
                question: "Quelle est la taille id√©ale d'une √©quipe Scrum de d√©veloppement ?",
                options: [
                    "1-3 personnes",
                    "3-9 personnes",
                    "10-15 personnes",
                    "Plus de 20 personnes"
                ],
                correct: 1,
                explanation: "L'√©quipe de d√©veloppement devrait avoir entre 3 et 9 personnes. Moins de 3 limite les interactions et peut cr√©er des manques de comp√©tences. Plus de 9 n√©cessite trop de coordination. Cette taille permet une communication efficace et une agilit√© optimale."
            },
            {
                question: "Qu'est-ce que le Sprint Backlog ?",
                options: [
                    "Tous les projets de l'entreprise",
                    "Les √©l√©ments du Product Backlog s√©lectionn√©s pour le Sprint + plan pour les livrer",
                    "Les bugs d√©couverts pendant le Sprint",
                    "Les cong√©s de l'√©quipe"
                ],
                correct: 1,
                explanation: "Le Sprint Backlog contient les √©l√©ments du Product Backlog s√©lectionn√©s pour le Sprint, plus un plan pour livrer l'incr√©ment du produit et atteindre l'objectif du Sprint. Il est g√©r√© par l'√©quipe de d√©veloppement et √©volue durant le Sprint."
            },
            {
                question: "Dans l'agilit√©, que signifie 'Les individus et leurs interactions' ?",
                options: [
                    "C'est moins important que les processus",
                    "C'est plus important que les processus et les outils",
                    "C'est √©gal aux processus",
                    "Cela ne concerne que le management"
                ],
                correct: 1,
                explanation: "C'est l'une des 4 valeurs du Manifeste Agile : 'Les individus et leurs interactions plus que les processus et les outils'. Cela signifie que m√™me si les processus sont importants, la communication humaine, la collaboration et les interactions de l'√©quipe ont plus de valeur."
            },
            {
                question: "Quelle c√©r√©monie permet √† l'√©quipe d'inspecter et d'am√©liorer son processus ?",
                options: [
                    "Le Daily Scrum",
                    "Le Sprint Planning",
                    "La Sprint Retrospective",
                    "La Sprint Review"
                ],
                correct: 2,
                explanation: "La Sprint Retrospective est une r√©union √† la fin du Sprint o√π l'√©quipe r√©fl√©chit sur le Sprint √©coul√© et identifie des am√©liorations concr√®tes pour le prochain Sprint. C'est le moment de l'am√©lioration continue du processus et des interactions de l'√©quipe."
            },
            {
                question: "Que signifie 'Definition of Done' (DoD) ?",
                options: [
                    "La fin du projet",
                    "Les crit√®res qu'un incr√©ment doit remplir pour √™tre consid√©r√© comme termin√©",
                    "La signature du client",
                    "La fin du Sprint"
                ],
                correct: 1,
                explanation: "La Definition of Done est un accord partag√© sur les crit√®res qu'un incr√©ment de produit doit satisfaire pour √™tre consid√©r√© comme 'Termin√©'. Elle peut inclure : code review√©, test√©, document√©, d√©ploy√©, etc. Elle assure une compr√©hension commune de la qualit√©."
            },
            {
                question: "Quelle valeur agile pr√¥ne 'R√©pondre au changement' ?",
                options: [
                    "Plut√¥t que de suivre un plan rigide",
                    "Plut√¥t que de communiquer avec le client",
                    "Plut√¥t que de livrer du logiciel",
                    "Plut√¥t que de documenter"
                ],
                correct: 0,
                explanation: "Le Manifeste Agile valorise 'L'adaptation au changement plus que le suivi d'un plan'. Dans un monde complexe et changeant, la capacit√© √† s'adapter rapidement aux nouvelles informations et besoins du client est plus pr√©cieuse qu'un plan d√©taill√© √©tabli au d√©but."
            }
        ];

        // √âtat de l'application
        let currentQuestionIndex = 0;
        let score = 0;
        let helpsRemaining = 3;
        let wrongAnswers = [];
        let answerSelected = false;
        let userAnswers = [];

        // Messages du professeur
        const professorMessages = {
            welcome: "Bienvenue dans ce quiz sur Scrum ! üéâ Je suis votre professeur virtuel et je vais vous accompagner tout au long de ce parcours. Vous disposez de 3 aides que vous pouvez utiliser √† tout moment. Bonne chance !",
            help: [
                "Hmm, laissez-moi vous donner un indice... ü§î Pensez √† la responsabilit√© principale de ce r√¥le !",
                "Je vais √©liminer une r√©ponse incorrecte pour vous aider ! ‚ú®",
                "Petit conseil : relisez bien la question et pensez aux principes fondamentaux de Scrum ! üí°"
            ],
            correct: [
                "Excellent ! üåü Vous ma√Ætrisez vraiment ce concept ! Continuez comme √ßa !",
                "Bravo ! üëè C'est exactement la bonne r√©ponse ! Vous √™tes sur la bonne voie !",
                "Parfait ! üéØ Vous avez une tr√®s bonne compr√©hension de Scrum !",
                "Super ! üöÄ Votre connaissance de Scrum est impressionnante !"
            ],
            incorrect: [
                "Pas tout √† fait, mais ne vous d√©couragez pas ! üí™ Chaque erreur est une opportunit√© d'apprentissage !",
                "Ce n'est pas grave ! üòä L'important est de comprendre pourquoi. Voyons ensemble...",
                "Presque ! üéì Laissez-moi vous expliquer la nuance importante ici...",
                "Ne vous inqui√©tez pas ! üå± C'est en pratiquant qu'on devient expert !"
            ],
            final: {
                excellent: "Extraordinaire ! üèÜ Vous √™tes un v√©ritable expert Scrum ! Votre ma√Ætrise des concepts est remarquable !",
                good: "Tr√®s bien ! üåü Vous avez une bonne compr√©hension de Scrum ! Continuez √† approfondir vos connaissances !",
                average: "Bon effort ! üìö Vous √™tes sur la bonne voie ! R√©visez les concepts et vous serez au top !",
                needsWork: "Courage ! üí™ Scrum demande de la pratique. Utilisez le PDF pour r√©viser et r√©essayez !"
            }
        };

        // Initialisation de l'application
        function init() {
            showWelcomeScreen();
        }

        // √âcran de bienvenue
        function showWelcomeScreen() {
            const app = document.getElementById('app');
            app.innerHTML = `
                <div class="welcome-screen">
                    <div class="professor-container" style="justify-content: center;">
                        <div class="professor">
                            <div class="professor-face">üë®‚Äçüè´</div>
                            <div class="professor-glasses">üëì</div>
                        </div>
                    </div>
                    <h2>Bienvenue dans le Quiz Scrum ! üéì</h2>
                    <p>${professorMessages.welcome}</p>
                    <div style="text-align: left; max-width: 600px; margin: 30px auto; background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3 style="margin-bottom: 15px; color: #667eea;">üìã R√®gles du jeu :</h3>
                        <ul style="line-height: 2; color: #555;">
                            <li>‚úÖ ${questionsData.length} questions sur les concepts Scrum</li>
                            <li>üéØ Une seule r√©ponse correcte par question</li>
                            <li>üí° 3 aides du professeur disponibles</li>
                            <li>üìù Explications d√©taill√©es apr√®s chaque r√©ponse</li>
                            <li>üìÑ PDF de r√©vision g√©n√©r√© √† la fin avec vos erreurs</li>
                        </ul>
                    </div>
                    <button class="btn btn-primary" onclick="startQuiz()">Commencer le Quiz üöÄ</button>
                </div>
            `;
        }

        // D√©marrer le quiz
        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            helpsRemaining = 3;
            wrongAnswers = [];
            userAnswers = [];
            showQuestion();
        }

        // Afficher une question
        function showQuestion() {
            answerSelected = false;
            const app = document.getElementById('app');
            const question = questionsData[currentQuestionIndex];
            const progress = ((currentQuestionIndex + 1) / questionsData.length) * 100;

            app.innerHTML = `
                <div class="stats">
                    <div class="stat-item">
                        <span class="emoji">üìä</span>
                        <span>Question ${currentQuestionIndex + 1}/${questionsData.length}</span>
                    </div>
                    <div class="stat-item">
                        <span class="emoji">‚≠ê</span>
                        <span>Score: ${score}/${currentQuestionIndex}</span>
                    </div>
                    <div class="stat-item">
                        <span class="emoji">üí°</span>
                        <span>Aides: ${helpsRemaining}/3</span>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%"></div>
                </div>

                <div class="professor-container">
                    <div class="professor" id="professor">
                        <div class="professor-face">üë®‚Äçüè´</div>
                        <div class="professor-glasses">üëì</div>
                    </div>
                    <div class="speech-bubble" id="speech">
                        Lisez attentivement la question et prenez votre temps pour r√©fl√©chir ! ü§î
                    </div>
                </div>

                <div class="question-container">
                    <div class="question">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectAnswer(${index})" data-index="${index}">
                                ${String.fromCharCode(65 + index)}. ${option}
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="controls">
                    <button class="btn btn-help" onclick="useHelp()" ${helpsRemaining === 0 ? 'disabled' : ''}>
                        üí° Demander de l'aide
                        <span class="help-count">${helpsRemaining}</span>
                    </button>
                    <button class="btn btn-primary" onclick="validateAnswer()" id="validateBtn" disabled>
                        Valider ma r√©ponse ‚úì
                    </button>
                </div>
            `;
        }

        // S√©lectionner une r√©ponse
        function selectAnswer(index) {
            if (answerSelected) return;

            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            options[index].classList.add('selected');
            
            document.getElementById('validateBtn').disabled = false;
            userAnswers[currentQuestionIndex] = index;
        }

        // Utiliser une aide
        function useHelp() {
            if (helpsRemaining === 0 || answerSelected) return;

            helpsRemaining--;
            const question = questionsData[currentQuestionIndex];
            const speech = document.getElementById('speech');
            
            // Animation du professeur
            const professor = document.getElementById('professor');
            professor.style.animation = 'none';
            setTimeout(() => {
                professor.style.animation = 'float 3s ease-in-out infinite';
            }, 10);

            // √âliminer une mauvaise r√©ponse
            const options = document.querySelectorAll('.option');
            const incorrectIndices = [];
            
            question.options.forEach((opt, index) => {
                if (index !== question.correct) {
                    incorrectIndices.push(index);
                }
            });

            // Choisir al√©atoirement une r√©ponse incorrecte √† √©liminer
            const toEliminate = incorrectIndices[Math.floor(Math.random() * incorrectIndices.length)];
            options[toEliminate].style.opacity = '0.3';
            options[toEliminate].style.pointerEvents = 'none';
            options[toEliminate].innerHTML += ' <span style="color: red;">‚ùå (√âlimin√©e)</span>';

            speech.innerHTML = `J'ai √©limin√© une r√©ponse incorrecte pour vous ! üí° Il vous reste maintenant ${helpsRemaining} aide(s). Bonne chance !`;
        }

        // Valider la r√©ponse
        function validateAnswer() {
            if (answerSelected) return;
            answerSelected = true;

            const question = questionsData[currentQuestionIndex];
            const selectedIndex = userAnswers[currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            const speech = document.getElementById('speech');

            // D√©sactiver toutes les options
            options.forEach(opt => opt.classList.add('disabled'));

            // Colorier les r√©ponses
            options[question.correct].classList.add('correct');
            if (selectedIndex !== question.correct) {
                options[selectedIndex].classList.add('incorrect');
            }

            // Mise √† jour du score et feedback
            const isCorrect = selectedIndex === question.correct;
            if (isCorrect) {
                score++;
                const randomCorrectMsg = professorMessages.correct[Math.floor(Math.random() * professorMessages.correct.length)];
                speech.innerHTML = `
                    <strong style="color: #4caf50; font-size: 1.2em;">${randomCorrectMsg}</strong>
                    <p style="margin-top: 15px; color: #333;">${question.explanation}</p>
                `;
            } else {
                wrongAnswers.push({
                    question: question.question,
                    correctAnswer: question.options[question.correct],
                    userAnswer: question.options[selectedIndex],
                    explanation: question.explanation
                });
                const randomIncorrectMsg = professorMessages.incorrect[Math.floor(Math.random() * professorMessages.incorrect.length)];
                speech.innerHTML = `
                    <strong style="color: #f44336; font-size: 1.2em;">${randomIncorrectMsg}</strong>
                    <p style="margin-top: 15px; color: #333;"><strong>La bonne r√©ponse √©tait :</strong> ${question.options[question.correct]}</p>
                    <p style="margin-top: 10px; color: #555;">${question.explanation}</p>
                `;
            }

            // Changer le bouton
            const validateBtn = document.getElementById('validateBtn');
            validateBtn.textContent = currentQuestionIndex < questionsData.length - 1 ? 'Question suivante ‚Üí' : 'Voir mes r√©sultats üéØ';
            validateBtn.onclick = nextQuestion;
            validateBtn.disabled = false;
        }

        // Question suivante
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questionsData.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        // Afficher les r√©sultats
        function showResults() {
            const app = document.getElementById('app');
            const percentage = Math.round((score / questionsData.length) * 100);
            let finalMessage = '';
            
            if (percentage >= 90) finalMessage = professorMessages.final.excellent;
            else if (percentage >= 70) finalMessage = professorMessages.final.good;
            else if (percentage >= 50) finalMessage = professorMessages.final.average;
            else finalMessage = professorMessages.final.needsWork;

            app.innerHTML = `
                <div class="results-screen">
                    <div class="professor-container" style="justify-content: center;">
                        <div class="professor">
                            <div class="professor-face">${percentage >= 70 ? 'üéâ' : 'üìö'}</div>
                            <div class="professor-glasses">üëì</div>
                        </div>
                    </div>
                    <h2>Quiz Termin√© ! üéä</h2>
                    <div class="score-display">${score}/${questionsData.length}</div>
                    <div style="font-size: 2em; margin: 20px 0;">${percentage}%</div>
                    <div class="feedback-message">${finalMessage}</div>
                    
                    <div style="text-align: left; max-width: 600px; margin: 30px auto; background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h3 style="margin-bottom: 15px; color: #667eea;">üìä Statistiques :</h3>
                        <ul style="line-height: 2; color: #555;">
                            <li>‚úÖ R√©ponses correctes : ${score}</li>
                            <li>‚ùå R√©ponses incorrectes : ${wrongAnswers.length}</li>
                            <li>üí° Aides utilis√©es : ${3 - helpsRemaining}/3</li>
                            <li>üìà Taux de r√©ussite : ${percentage}%</li>
                        </ul>
                    </div>

                    ${wrongAnswers.length > 0 ? `
                        <p style="color: #666; margin: 20px 0;">
                            üìÑ T√©l√©chargez votre PDF de r√©vision contenant les ${wrongAnswers.length} question(s) que vous avez manqu√©e(s) avec les explications d√©taill√©es.
                        </p>
                        <button class="btn btn-download" onclick="generatePDF()">
                            üì• T√©l√©charger mon PDF de r√©vision
                        </button>
                    ` : `
                        <p style="color: #4caf50; font-size: 1.2em; margin: 20px 0;">
                            üèÜ Parfait ! Vous avez r√©pondu correctement √† toutes les questions !
                        </p>
                    `}
                    
                    <button class="btn btn-primary" onclick="init()" style="margin-top: 20px;">
                        üîÑ Recommencer le quiz
                    </button>
                </div>
            `;
        }

        // G√©n√©rer le PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Configuration
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const maxWidth = pageWidth - 2 * margin;
            let y = margin;

            // Titre
            doc.setFillColor(102, 126, 234);
            doc.rect(0, 0, pageWidth, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.text('Quiz Scrum - R√©vision', pageWidth / 2, 25, { align: 'center' });

            y = 50;
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(12);
            doc.text(`Date: ${new Date().toLocaleDateString('fr-FR')}`, margin, y);
            y += 10;
            doc.text(`Score: ${score}/${questionsData.length} (${Math.round((score / questionsData.length) * 100)}%)`, margin, y);
            y += 15;

            doc.setFontSize(16);
            doc.setTextColor(102, 126, 234);
            doc.text(`Questions √† r√©viser (${wrongAnswers.length})`, margin, y);
            y += 15;

            // Questions incorrectes
            doc.setFontSize(11);
            wrongAnswers.forEach((item, index) => {
                // V√©rifier si on a besoin d'une nouvelle page
                if (y > pageHeight - 60) {
                    doc.addPage();
                    y = margin;
                }

                // Num√©ro de question
                doc.setFillColor(244, 67, 54);
                doc.circle(margin + 3, y - 2, 3, 'F');
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(12);
                doc.setFont(undefined, 'bold');
                doc.text(`Question ${index + 1}:`, margin + 10, y);
                y += 8;

                // Question
                doc.setFont(undefined, 'normal');
                doc.setFontSize(11);
                const questionLines = doc.splitTextToSize(item.question, maxWidth - 10);
                doc.text(questionLines, margin + 10, y);
                y += questionLines.length * 6 + 5;

                // Votre r√©ponse
                doc.setTextColor(244, 67, 54);
                doc.setFont(undefined, 'bold');
                doc.text('‚ùå Votre r√©ponse:', margin + 10, y);
                doc.setFont(undefined, 'normal');
                y += 6;
                const userAnswerLines = doc.splitTextToSize(item.userAnswer, maxWidth - 15);
                doc.text(userAnswerLines, margin + 15, y);
                y += userAnswerLines.length * 6 + 3;

                // Bonne r√©ponse
                doc.setTextColor(76, 175, 80);
                doc.setFont(undefined, 'bold');
                doc.text('‚úì Bonne r√©ponse:', margin + 10, y);
                doc.setFont(undefined, 'normal');
                y += 6;
                const correctAnswerLines = doc.splitTextToSize(item.correctAnswer, maxWidth - 15);
                doc.text(correctAnswerLines, margin + 15, y);
                y += correctAnswerLines.length * 6 + 3;

                // Explication
                doc.setTextColor(102, 126, 234);
                doc.setFont(undefined, 'bold');
                doc.text('üí° Explication:', margin + 10, y);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(80, 80, 80);
                y += 6;
                const explanationLines = doc.splitTextToSize(item.explanation, maxWidth - 15);
                doc.text(explanationLines, margin + 15, y);
                y += explanationLines.length * 6 + 10;

                // Ligne de s√©paration
                if (index < wrongAnswers.length - 1) {
                    doc.setDrawColor(200, 200, 200);
                    doc.line(margin, y, pageWidth - margin, y);
                    y += 10;
                }
            });

            // Pied de page sur la derni√®re page
            doc.setFontSize(10);
            doc.setTextColor(150, 150, 150);
            doc.text('G√©n√©r√© par Quiz Scrum Interactif - Bonne r√©vision ! üéì', pageWidth / 2, pageHeight - 10, { align: 'center' });

            // T√©l√©charger le PDF
            doc.save(`Scrum_Quiz_Revision_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        // D√©marrer l'application
        init();
    </script>
</body>
</html>
